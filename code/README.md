This file describes the scripts found in the `code` directory. The subdirectory `modules` contains the main functions involved with each analysis. All data formatting, transformation, and handling are performed within script stores in the `handlers` subdirectory.  They contain all code used in the pipeline from dataset preparation, taxonomic harmonisation, data cleaning, and spatial and endemicity analyses. The pipeline is structured and meant to be used in the order indicated by main scripts (`run1_total_numbers.py`, `run2_spatial_analysis.py`, and `run3_endemic_analysis.py`).

### 1) Data precleaning, taxonomic harmonisation, and total species estimate (`run1_total_numbers.py`)
Pre-clean data by removing duplicates and unwanted occurrences based on the record type. Prepares the [MycoBank](https://mycobank.org) database for taxonomic harmonisation using the auxiliary function in `format_mb.py`. If Species Hypotheses are present, pull data on taxonomy via the [PlutoF API](https://plutof.docs.apiary.io/#). Perform taxonomic harmonisation of all occurrences gathered from GBIF based on exact matches and a two-step fuzzy matching.

### 2) Spatial analysis (`run2_spatial_analysis.py`)
Estimates the total number of valid and digitally accessible fungal species names for each Neotropical province sensu [Morrone et al. (2023)]( https://doi.org/10.1590/0001-3765202220211167) that intersects with Brazilian territory based on the harmonised and pre-cleaned GBIF occurrence dataset on: a) coordinates for georeferenced occurrences and b) by generating centroids for non-georeferenced occurrences with detailed metadata for the collection locality.

### 3) Endemicity analysis (`run3_endemic_analysis.py`)
Retrieve usage Keys for creating occurrence download requests via the GBIF API. Download available occurrences for all known, digitally accessible, and accepted fungal species names retrieved in `data_precleaning.py`. Based on available occurrences for each species name, infer its endemicity status based on the associated country for each occurrence under species names.
